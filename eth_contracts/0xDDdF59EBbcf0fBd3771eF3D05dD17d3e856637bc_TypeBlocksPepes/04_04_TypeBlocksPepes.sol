// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

import "@openzeppelin/contracts/utils/Strings.sol";
import "@openzeppelin/contracts/utils/Base64.sol";

contract TypeBlocksPepes {

    uint256 internal constant XSTART = 313;
    uint256 internal constant YSTART = 306;
    uint256 internal constant SPACING = 40;

    function ALPHABETPLOT(bytes1 letter) internal pure returns (uint8[20] memory) {
        if(letter == 0x41) {
            return [ 2, 3, 4, 6, 10, 11, 15, 16, 20, 21, 22, 23, 24, 25, 26, 30, 31, 35, 0, 0 ];
        } else if(letter == 0x42) {
            return [ 1, 2, 3, 4, 6, 10, 11, 15, 16, 17, 18, 19, 21, 25, 26, 30, 31, 32, 33, 34 ];
        } else if(letter == 0x43) {
            return [ 2, 3, 4, 6, 10, 11, 16, 21, 26, 30, 32, 33, 34, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x44) {
            return [ 1, 2, 3, 4, 6, 10, 11, 15, 16, 20, 21, 25, 26, 30, 31, 32, 33, 34, 0, 0 ];
        } else if(letter == 0x45) {
            return [ 1, 2, 3, 4, 5, 6, 11, 16, 17, 18, 19, 21, 26, 31, 32, 33, 34, 35, 0, 0 ];
        } else if(letter == 0x46) {
            return [ 1, 2, 3, 4, 5, 6, 11, 16, 17, 18, 19, 21, 26, 31, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x47) {
            return [ 2, 3, 4, 6, 10, 11, 16, 21, 24, 25, 26, 30, 32, 33, 34, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x48) {
            return [ 1, 5, 6, 10, 11, 15, 16, 17, 18, 19, 20, 21, 25, 26, 30, 31, 35, 0, 0, 0 ];
        } else if(letter == 0x49) {
            return [ 2, 3, 4, 8, 13, 18, 23, 28, 32, 33, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x4A) {
            return [ 2, 3, 4, 5, 9, 14, 19, 24, 26, 29, 32, 33, 0, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x4B) {
            return [ 1, 5, 6, 9, 11, 13, 16, 17, 21, 23, 26, 29, 31, 35, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x4C) {
            return [ 1, 6, 11, 16, 21, 26, 31, 32, 33, 34, 35, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x4D) {
            return [ 1, 5, 6, 7, 9, 10, 11, 13, 15, 16, 20, 21, 25, 26, 30, 31, 35, 0, 0, 0 ];
        } else if(letter == 0x4E) {
            return [ 1, 5, 6, 7, 10, 11, 13, 15, 16, 19, 20, 21, 25, 26, 30, 31, 35, 0, 0, 0 ];
        } else if(letter == 0x4F) {
            return [ 2, 3, 4, 6, 10, 11, 15, 16, 20, 21, 25, 26, 30, 32, 33, 34, 0, 0, 0, 0 ];
        } else if(letter == 0x50) {
            return [ 1, 2, 3, 4, 6, 10, 11, 15, 16, 17, 18, 19, 21, 26, 31, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x51) {
            return [ 2, 3, 4, 6, 10, 11, 15, 16, 20, 21, 23, 25, 26, 29, 30, 32, 33, 34, 35, 0 ];
        } else if(letter == 0x52) {
            return [ 1, 2, 3, 4, 6, 10, 11, 15, 16, 17, 18, 19, 21, 23, 26, 29, 31, 35, 0, 0 ];
        } else if(letter == 0x53) {
            return [ 2, 3, 4, 6, 10, 11, 17, 18, 19, 25, 26, 30, 32, 33, 34, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x54) {
            return [ 1, 2, 3, 4, 5, 8, 13, 18, 23, 28, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x55) {
            return [ 1, 5, 6, 10, 11, 15, 16, 20, 21, 25, 26, 30, 32, 33, 34, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x56) {
            return [ 1, 5, 6, 10, 11, 15, 16, 20, 21, 25, 27, 29, 33, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x57) {
            return [ 1, 5, 6, 10, 11, 15, 16, 20, 21, 23, 25, 26, 28, 30, 32, 34, 0, 0, 0, 0 ];
        } else if(letter == 0x58) {
            return [ 1, 5, 6, 10, 11, 15, 17, 18, 19, 21, 25, 26, 30, 31, 35, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x59) {
            return [ 1, 5, 6, 10, 11, 15, 17, 18, 19, 23, 28, 33, 0, 0, 0, 0, 0, 0, 0, 0 ];
        } else if(letter == 0x5A) {
            return [ 1, 2, 3, 4, 5, 10, 14, 18, 22, 26, 31, 32, 33, 34, 35, 0, 0, 0, 0, 0 ];
        } else {
            return [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
        }
    }

    function generateArt(bytes1[] memory letters, string memory color) external pure returns (string memory) {
        return Base64.encode(abi.encodePacked(
            '<svg ',
                'viewBox="0 0 500 500" ',
                'fill="none" xmlns="http://www.w3.org/2000/svg" ',
                'style="width:100%;background:#111;"',
            '>',
                '<rect width="500" height="500" fill="#111"/>',
                '<g><path fill="#019a02" d="M156.9,266h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,267.8,154.8,266,156.9,266z"/><path fill="#019a02" d="M196.9,266h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,267.8,194.8,266,196.9,266z"/><path fill="#019a02" d="M236.9,266h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,267.8,234.8,266,236.9,266z"/><path fill="#019a02" d="M276.9,266h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,267.8,274.8,266,276.9,266z"/><path fill="#019a02" d="M316.9,266h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,267.8,314.8,266,316.9,266z"/><path fill="#019a02" d="M156.9,360h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,361.8,154.8,360,156.9,360z"/><path fill="#019a02" d="M196.9,360h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,361.8,194.8,360,196.9,360z"/><path fill="#019a02" d="M236.9,360h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,361.8,234.8,360,236.9,360z"/><path fill="#019a02" d="M276.9,360h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,361.8,274.8,360,276.9,360z"/><path fill="#019a02" d="M316.9,360h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,361.8,314.8,360,316.9,360z"/><path fill="#019a02" d="M156.9,226h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,227.8,154.8,226,156.9,226z"/><path fill="#019a02" d="M196.9,226h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,227.8,194.8,226,196.9,226z"/><path fill="#019a02" d="M236.9,226h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,227.8,234.8,226,236.9,226z"/><path fill="#019a02" d="M276.9,226h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,227.8,274.8,226,276.9,226z"/><path fill="#019a02" d="M316.9,226h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,227.8,314.8,226,316.9,226z"/><path fill="#fff" d="M156.9,186h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,187.8,154.8,186,156.9,186z"/><path fill="#000" d="M196.9,186h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,187.8,194.8,186,196.9,186z"/><path fill="#019a02" d="M236.9,186h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,187.8,234.8,186,236.9,186z"/><path fill="#fff" d="M276.9,186h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,187.8,274.8,186,276.9,186z"/><path fill="#000" d="M316.9,186h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,187.8,314.8,186,316.9,186z"/><path fill="#fff" d="M156.9,146h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,147.8,154.8,146,156.9,146z"/><path fill="#000" d="M196.9,146h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,147.8,194.8,146,196.9,146z"/><path fill="#019a02" d="M236.9,146h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,147.8,234.8,146,236.9,146z"/><path fill="#fff" d="M276.9,146h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,147.8,274.8,146,276.9,146z"/><path fill="#000" d="M316.9,146h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,147.8,314.8,146,316.9,146z"/><path fill="#019a02" d="M156.9,106h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C153,107.8,154.8,106,156.9,106z"/><path fill="#019a02" d="M196.9,106h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C193,107.8,194.8,106,196.9,106z"/><path fill="#019a02" d="M236.9,106h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C233,107.8,234.8,106,236.9,106z"/><path fill="#019a02" d="M276.9,106h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C273,107.8,274.8,106,276.9,106z"/><path fill="#019a02" d="M316.9,106h26.2c2.2,0,3.9,1.8,3.9,3.9v26.2c0,2.2-1.8,3.9-3.9,3.9h-26.2c-2.2,0-3.9-1.8-3.9-3.9v-26.2 C313,107.8,314.8,106,316.9,106z"/></g>',
                generateBlocks(letters, color),
            '</svg>'
        ));
    }

    function generateBlocks(bytes1[] memory letters, string memory color) internal pure returns (bytes memory blocks) {
        for (uint256 i; i < 5; i++) {
            blocks = abi.encodePacked(
                blocks,
                '<g>',
                generateBlock(i, letters, color),
                '</g>'
            );
        }

        return blocks;
    }
    
    function generateBlock(uint256 number, bytes1[] memory letters, string memory color) internal pure returns (bytes memory typeBlock) {
        uint256 xStart = XSTART - number * SPACING;
        uint256 yStart = YSTART;
        string memory opacity = "0.09";
        uint256 count = 1;
        bytes1 letter;

        if(letters.length > 0 && number < letters.length ) {
            letter = letters[letters.length - 1 - number];
        }
        
        for (uint256 i; i < 7; i++) {
            for (uint256 j; j < 5; j++) {
                uint256 cx = xStart + (j * 7);
                uint256 cy = yStart + (i * 7);
                uint8[20] memory plot = ALPHABETPLOT(letter);
                
                for (uint256 k; k < plot.length; k++) {
                    opacity = "0.3";
                    if(0 == plot[k]) {
                        break;
                    } else if(count == plot[k]) {
                        opacity = "1";
                        break;
                    }
                }
                
                typeBlock = abi.encodePacked(
                    typeBlock,
                    '<rect x="', Strings.toString(cx), '" y="', Strings.toString(cy), '" fill="#cf0001" fill-opacity="', opacity ,'" width="6" height="6" rx=".69" ry=".69"/>'
                );
                unchecked { count++; }
            }
        }

        return typeBlock;
    }
}