{"SourceCode": "# @version 0.3.10\r\n\"\"\"\r\n@title Gauge factory\r\n@author 1up\r\n@license GNU AGPLv3\r\n@notice\r\n    Permissionless deployment of gauges from the Yearn registry.\r\n    Deployed gauges are immediately added to the registry.\r\n\"\"\"\r\n\r\ninterface YearnRegistry:\r\n    def registered(_ygauge: address) -> bool: view\r\n\r\ninterface Registry:\r\n    def register(_gauge: address) -> uint256: nonpayable\r\n\r\nyearn_registry: public(immutable(YearnRegistry))\r\nreward_token: public(immutable(address))\r\nproxy: public(immutable(address))\r\nregistry: public(immutable(Registry))\r\nrewards: public(immutable(address))\r\nmanagement: public(address)\r\npending_management: public(address)\r\ngauge_blueprint: public(address)\r\n\r\nevent DeployGauge:\r\n    ygauge: indexed(address)\r\n    gauge: address\r\n\r\nevent SetGaugeBlueprint:\r\n    blueprint: address\r\n\r\nevent PendingManagement:\r\n    management: address\r\n\r\nevent SetManagement:\r\n    management: address\r\n\r\n@external\r\ndef __init__(_yearn_registry: address, _reward_token: address, _proxy: address, _registry: address, _rewards: address):\r\n    \"\"\"\r\n    @notice Constructor\r\n    @param _yearn_registry Yearn registry address\r\n    @param _reward_token Reward token\r\n    @param _proxy Proxy\r\n    @param _registry Registry\r\n    @param _rewards Gauge rewards contract\r\n    \"\"\"\r\n    yearn_registry = YearnRegistry(_yearn_registry)\r\n    reward_token = _reward_token\r\n    proxy = _proxy\r\n    registry = Registry(_registry)\r\n    rewards = _rewards\r\n    self.management = msg.sender\r\n\r\n@external\r\ndef deploy_gauge(_ygauge: address) -> address:\r\n    \"\"\"\r\n    @notice Deploy a new gauge for a Yearn gauge using the current blueprint\r\n    @param _ygauge The yearn gauge\r\n    @return New gauge address\r\n    @dev Calls registry to register gauge\r\n    \"\"\"\r\n    assert yearn_registry.registered(_ygauge)\r\n\r\n    gauge: address = create_from_blueprint(\r\n        self.gauge_blueprint,\r\n        _ygauge,\r\n        proxy,\r\n        reward_token,\r\n        rewards,\r\n        code_offset=3\r\n    )\r\n    log DeployGauge(_ygauge, gauge)\r\n    registry.register(gauge)\r\n    return gauge\r\n\r\n@external\r\ndef set_gauge_blueprint(_blueprint: address):\r\n    \"\"\"\r\n    @notice Set a new gauge blueprint\r\n    @param _blueprint Gauge blueprint address\r\n    @dev Can only be called by management\r\n    \"\"\"\r\n    assert msg.sender == self.management\r\n    assert _blueprint != empty(address)\r\n    self.gauge_blueprint = _blueprint\r\n    log SetGaugeBlueprint(_blueprint)\r\n\r\n@external\r\ndef set_management(_management: address):\r\n    \"\"\"\r\n    @notice \r\n        Set the pending management address.\r\n        Needs to be accepted by that account separately to transfer management over\r\n    @param _management New pending management address\r\n    \"\"\"\r\n    assert msg.sender == self.management\r\n    self.pending_management = _management\r\n    log PendingManagement(_management)\r\n\r\n@external\r\ndef accept_management():\r\n    \"\"\"\r\n    @notice \r\n        Accept management role.\r\n        Can only be called by account previously marked as pending management by current management\r\n    \"\"\"\r\n    assert msg.sender == self.pending_management\r\n    self.pending_management = empty(address)\r\n    self.management = msg.sender\r\n    log SetManagement(msg.sender)", "ABI": "[{\"name\":\"DeployGauge\",\"inputs\":[{\"name\":\"ygauge\",\"type\":\"address\",\"indexed\":true},{\"name\":\"gauge\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"SetGaugeBlueprint\",\"inputs\":[{\"name\":\"blueprint\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"PendingManagement\",\"inputs\":[{\"name\":\"management\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"SetManagement\",\"inputs\":[{\"name\":\"management\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"inputs\":[{\"name\":\"_yearn_registry\",\"type\":\"address\"},{\"name\":\"_reward_token\",\"type\":\"address\"},{\"name\":\"_proxy\",\"type\":\"address\"},{\"name\":\"_registry\",\"type\":\"address\"},{\"name\":\"_rewards\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"deploy_gauge\",\"inputs\":[{\"name\":\"_ygauge\",\"type\":\"address\"}],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"set_gauge_blueprint\",\"inputs\":[{\"name\":\"_blueprint\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"set_management\",\"inputs\":[{\"name\":\"_management\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"accept_management\",\"inputs\":[],\"outputs\":[]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"yearn_registry\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"reward_token\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"proxy\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"registry\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"rewards\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"management\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"pending_management\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"gauge_blueprint\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]}]", "ContractName": "Gauge factory", "CompilerVersion": "vyper:0.3.10", "OptimizationUsed": "0", "Runs": "0", "ConstructorArguments": "0000000000000000000000001d0fdcb628b2f8c0e22354d45b3b2d4ce9936f8b00000000000000000000000041252e8691e964f7de35156b68493bab6797a275000000000000000000000000242521ca01f330f050a65ff5b8ebbe92198ae64f000000000000000000000000512adcb1e162bf447919d46ae5b42d9331e9df5d00000000000000000000000035440c602bc4f01bbec6cb616ccb901c9df5475f", "EVMVersion": "Default", "Library": "", "LicenseType": "GNU AGPLv3", "Proxy": "0", "Implementation": "", "SwarmSource": ""}