// SPDX-License-Identifier: MIT

//MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOxol:;''.............',:codk0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdc;'...',;clloddxxxxxxddoolc:;'....,cokKNMMMMMMMMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMMMWKkl;...':ldkO0KKXXKKKK00000KKKKKXXXKK0kxl:,...,cxKNMMMMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMN0d;...;lxOKKXK0Oxdoc:;,,'''''''',,;:codkO0KXXK0xo:'..,oONMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMWKd;..'cxOKXK0koc;'...  ................  ...';cok0KXK0kl;..,o0NMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMNk:..'lk0XK0xl;..  ....',,,,,;,,,,,,,,,,,,,,'....  ..;lk0KXKko;..;xXMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMXx,..:x0KK0xc'. ...',,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'..  .'cx0KXKkc..'oKWMMMMMMMMMMMMM
//MMMMMMMMMMMMXx'..lkKXKkc'. ..',,,;,,;,,,,,,,,,''''''',,,,;,,,,,,,,,;,,'.. .'lkKXKOo,..lKWMMMMMMMMMMM
//MMMMMMMMMMNk,..lOKK0d;. ..',,,,,,,,,,,,'....  .        ....',,,,,,,,,,,,,'.. .:x0XK0o'..dXMMMMMMMMMM
//MMMMMMMMWKc..:kKX0d,  .',,;,,,,,,,,'..  .';clllooolllc:;,..  ..',,,,,,,,,,,,.. .;x0XXOl. ;OWMMMMMMMM
//MMMMMMMNx' ,xKKKx;  .',,,,,,,,,,,..  'coooc:;''..''',;:cloooc'. ..,,,;,,,,,,,,'. .;kKKKk:..oXMMMMMMM
//MMMMMMXl..cOKXOc. .',,,,,,,'.....  ,oxl,.                 .,cddc. ..,,,,,,,,,,,,.. .l0KK0o. :0MMMMMM
//MMMMMK: .oKXKx,  .,,,,,,'......  .lxc.                        'lxc.     ....',;,,,.  ;kKXKx, ,OWMMMM
//MMMMK; 'xKXKo. .',,,,,,...clcclccxx,                            ,xd' .;:::;...',,,,'. .dKXKk; 'kWMMM
//MMMK: 'xKX0l. .',,,,,,..;dc,,;:d0x'                              .dkdxdl:;co:..',,,,'. .oKXKO; 'OWMM
//MMXc .dKX0l. .,,,,,,,'.,xc,ol;ckO;                                .dKkc;cl.'d: .,,,,,,. .oKXKk, ,0MM
//MWd..oKXKo. .,,,,,,,,..lx',d; ;kl.                                 ,ko. ;o'.oo. .,,,,,,. .dKXKx' cXM
//MO' :0XKk' .',,,,,,,,..od. :dlxk'                                  .dk;:o, .oo. .,,,,,,'. ,kXXKo..dW
//Nl 'kXX0:  ',,,,,,,,,. cx, :olko.                                   cOxoo, ,d;  .,,,,;,,.  c0XXO; ,K
//O. cKXKd. .,;,,;,,,,,' .oo,cdoOl                                    ;Ol.cl'oo. .,,,,,,,,,. .xXXKd..d
//o .xXX0:  ',;,,,,,,,,,. .:dook0c                                    'kkllcld' .,,,,,,,,,,'  cKXXO; ;
//; ;OXXk' .,,,,,,,,,,,,,.  .:cx0c                                    .xKkolc...,,,,,,,,,,,,. ,OXXKl .
//. cKXXd. .,,,,,,,,,,,,,,'.   ;Oc          .,ccclc;,:cllll;.         .xx;....,,,,,,,,,,,,,,. .xXXXd. 
//..lKXKo. .,,,,,,,,,,,,,,,,'. ;Oc         ,ddddoodOKkodxxxkd'        .xo. .,,,,,,,,,,,,,,,,. .dXKXx. 
// .oKXKl  .,,,,,,,,,,,,,,,,,. ;O:   ..;clokddO0KKdcc;lOKOOdodl:;'..  ,kl .',,,,,,,,,,,,,,,,. .oKXXx. 
//  lKKKl. .,,,,,,,,,,,,,,,,,. :Oc.,cll:,.';',,':c'    .'.....';:clll:lOc  .,,,,,,,,,,,,,,,,. .oKXXx. 
//. :0XKd. .,,,,,,,,,,,,,,,,,. ;Okdl,.                             .':dOo.  .',;,,,,,,,,,,,,. .xXXKo. 
//. ,OXXk' .',,,,,,,,,,,,,,,.  cOo.                                    'ld,  .,,,,,,,,,,,,,'. ,OXX0c  
//; .dKX0:  .,,,,,,,,,,,,,,.  'xl.                                      .ox.  .,,,,,,,,,,,,.  cKXKk, .
//d. cOXKd. .,,,,,,,,,,,,,'. .lx.                                        :k,  .,,,,,,,,,,,'. .xKKKo. :
//0, 'dKX0;  .,,,,,,,,,,,,'  .od.                                        cx'  .,,,,,,,,,,,.  :0XKk; .x
//Wo..:kKKx. .',,;,,,,,,,;'   cx'                                       ,xc  .',,,,,,,,,,.  'kKKOl. :X
//MK; .lOKKl. .',,,,,,,,,,,.  .do.                                     ,dl.  ',,;,,,,,,,'. .oKX0d' .kM
//MWk. 'oOK0c  .',,,;,,,,,,'.  .ld:.                                 .cdc. .',,,,,,,,,,'. .l0X0d;  oNM
//MMNo. ,oOK0c. .',,,,,,,,,,,.   'col:,..                        .':ll:. ..,,,,,,,,,,,.. .l0X0x;. :XMM
//MMMNl. ,oOK0l.  .,,,;,,,;,,,,..  .';cclclcc:;,'........',;::ccllc;.  ..,,,,,,,,,;,,.  .o0K0d;. ;KMMM
//MMMMXl. 'lkKKd.  .',,,,,,,,,,,,,'...   ...,;cxxlccccccdko:;,'..   ..',,,,,,,,,,,,'.  'xKKOo;. ;KMMMM
//MMMMMNo. 'cdOKk:.  .',,,,,,,,,,,,,,,'..     .ll.      ,d'     ..',,,,,,,,,,,,,,'.  .:OK0xl,  :KMMMMM
//MMMMMMWx. .;ox00d'  ..',,,,,,,,,,'..   ....';xl       ,xc'.........',,,,,,,,,'.   ,dKKko:. .oXMMMMMM
//MMMMMMMW0:. 'cok0Ol.   .',,,,,,...':looooooool'       .:loooooolc;....,,,,,'.   'o0KOdc,. 'kWMMMMMMM
//MMMMMMMMMNd. .,cdk0Oo'   ..','..;dxl;'...                   ..',:oxo' ..'..  .,o0KOdl;. .lKMMMMMMMMM
//MMMMMMMMMMWKl. .;coxOOd:.   . .lkc.                               'ok:     .:x00kdl:. .;OWMMMMMMMMMM
//MMMMMMMMMMMMW0c. .,cldkOko;. .dO:                                  .lkc..;oO0Oxoc;. .;kNMMMMMMMMMMMM
//MMMMMMMMMMMMMMW0l. .';codkOkxk0l.                                   ,x0kOOkxol:,. .:kNMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMWKd,. .':cldxkOkdl;'.                          .';ldkOOxdol:,...'l0WMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMNOo,. .';:clodxkkkxolc:,''..........',;:cldxkOkkxdolc;'...'ckXMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMNOo;....',:ccloodxxkkkkkxxxxxxxxkkkkkxxddollc:;,....,lkXWMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMMMMWKkl;.....',;;:cccllllllllllllllccc::;,'.....,lx0NMMMMMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX0xl:,..........''''''''..........';ldOKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
//MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdc;'.              ..,:ok0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM             
////////////////////////////////////////Chimps Pimps CC0 contract/////////////////////////////////////

pragma solidity ^0.8.4;

import "erc721a/contracts/ERC721A.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/utils/Strings.sol";

contract ChimpsPimps is ERC721A, Ownable {
    uint256 public constant TOTAL_CHIMPS = 2420;
    uint256 public constant FREE_CHIMPS = 5;
    uint256 public constant PRICE_CHIMP_MINT = 0.0042 ether;
    bool public ChimpsArePimps = false;
    mapping(address => bool) public AreYouPimp;
    string private _baseTokenURI;

    constructor(
        string memory _initBaseURI
    ) ERC721A("ChimpsPimps", "CSP") {
        _baseTokenURI = _initBaseURI;
    }

    function _startTokenId() internal view virtual override returns (uint256) {
        return 1;
    }

    function mintFreeChimp() public {
        require(ChimpsArePimps, "Chimps must be Pimps");
        require(totalSupply() + FREE_CHIMPS <= TOTAL_CHIMPS, "Not enough Chimps remaining");
        require(!AreYouPimp[_msgSender()], "You are alredy pimp");
        AreYouPimp[_msgSender()] = true;
        _safeMint(msg.sender, FREE_CHIMPS);
    }

    function mintChimpPimp(uint256 chimps) public payable {
        require(ChimpsArePimps, "Chimps must be Pimps");
        require(totalSupply() + chimps <= TOTAL_CHIMPS, "Not enough Chimps remaining");
        require(msg.value >= chimps * PRICE_CHIMP_MINT, "Not enough ETH");
        _safeMint(msg.sender, chimps);
    }

    function reserveMint(uint256 quantity) external onlyOwner {
        require(totalSupply() + quantity <= TOTAL_CHIMPS, "Not enough Chimps remaining");
        _safeMint(msg.sender, quantity);
    }

    function tokenURI(uint256 tokenId) public view virtual override returns (string memory)
    {
        require(_exists(tokenId), "NFT does not exist");
        string memory baseURI = _baseURI();
        return
            bytes(baseURI).length > 0
                ? string(
                    abi.encodePacked(
                        baseURI,
                        Strings.toString(tokenId),
                        ".json"
                    )
                )
                : "";
    }
    
    function setChimpsPimps(bool _areChimpsPimps) external onlyOwner {
        ChimpsArePimps = _areChimpsPimps;
    }

    function _baseURI() internal view virtual override returns (string memory) {
        return _baseTokenURI;
    }

    function setBaseURI(string calldata baseURI) external onlyOwner {
        _baseTokenURI = baseURI;
    }

    function withdrawEther() external onlyOwner {
        uint256 balance = address(this).balance;
        payable(msg.sender).transfer(balance);
    }
}