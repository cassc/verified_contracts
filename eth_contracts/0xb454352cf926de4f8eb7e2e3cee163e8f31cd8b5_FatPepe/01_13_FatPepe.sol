//                                                ▄▄▄▄▄▄▄▄▄
//                                  ▄▄▀▀▀▀▀▀▀▀▀▄█▀╦      ``▀▀▄
//                             ,██▒▒▒▒▒@@,,@M▄,,▄█▒▒@@@@, ,██ ▀▀██,
//                           ▄█▒▒▒▒▒▒▒▒▒▄▄▀▀▀▀   ▀▀▀█▄▒ ▄▀         ▀▄
//                          ▄▀▒▒▒╢╣▒▒▒▄▀     ▄▄▄▄▄▄▄ ▀▄▀▄▄▄▄▄▄▄▄▄    ▀▄
//                        ▄▄█▒╢▒▒▒▒▒▓▀  ▓▓""█████  ▀█"█████  ▀█  ""▄  █
//                      ▄▀▒█▒▒▒╣▒▒`█ ▄Ñ▓`   █████▄▄██ █████▄▄██     ▀▄█
//                   ,█▒▒▒█▒▒▒▒▒▒╩   ,       ███████,▄ ███████    ,▄██
//                  ▄█▒▒▒▒▒╢▒▒▒▒╩     R,,,,,,,╢╢╢╢▀▓▀   ▀╢,,,,,,,▓█   ▀▄
//                  █▒▒▒▒▒▒▒▒▒▀         ▄▄▄▄▄▄▄▄▄▀▀       ▀▀▀▀▀         █
//                  █╜╙"╢▒▒▒▒▒"                                         ▀▄
//                  █      ▓╜▒▒▒▒▒▒▒        ▒░╦╢▄mmgææ              ╦mmm▓█
//              ,█,▀█                          ▓▒▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▒█,
//             █▒▄██,█▄    ,                    ╝▓▓▓▒╢╢╢╢╢╢╢╢╢╢╢╢╢╢╢▓▓▓▓▓█
//             ██▒▓▄▄▄▒█▄   ▒,,,╓                 ╙╙╙▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀╙╙╙╙█
//             ████╣▓█▓█▓███▄▄▄     ╖╖╖╖╖╖                            ▄▄█
//                 ▀██▒▓▓█▓▓░▀█▀▀▀▀▄▄▄▄▄▄▄▄▄   ;;;;;;;;;;;▄▄▄▄▄▄▀▀▀▀▀▀▓░░▀▄
//                  ██▓█▒▒▓▓▒░░█░░╢ ▒╢░▒░▓░@ ,                 ,Ñ▓▓▓▓▓▓▄█▀
//                  █▄▒████▄▒▒▓░╝╢╢,▒,▒╢╩▄▄▓▓▓█,            ▄█▓╩░█▓▄▄▄▄█
//                  ██▓╣╣▓██████████▓▓▓▄▄▓╢▓███████▄     ▄███▓▒╖▄▓▓╢▓███
//                 █╣▀▀▀█████▓▓█▓█▓█████████▓▓▓▓██▓█▓▄██▓▓▓▓▓▓▓▓▓▓▓█─██
//                  ▀█▒▓▓▓▓░▀▓▓▀æ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀███▓▓████████▀▓▒▓░▓█
//                    █▒╣▓▓▒▓▓▓▒╢, M,           ,NM▒░░░░░░▒@@@╩@▓░░░░▄█▀
//                      ▀▄╣▓▓▓▒▒     ─,       ,M      ╨▒,,╩     ▓▓▓▄▀
//                        ▀▀███▄╣╣╓▄   *,   ╓╨       ^  ╙▀ ╙   ▀██▀
//                              ▀▀████▒╢╗╦▄╣╗╗╗╗╗╗╗╗╗╗╗╦╗╗╗▄██▀▀
//                                   ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
//                               ▌╙░
//                          ░^^╙▄▄▄ ╙▄      ▄▄æ▒
//                           ▐` ╚`  █@▀▄██▀▄█▄  ██▄
//                          ▄   ▄╢▌ ▒▄████ ╚█,`¿█▓▓▌
//                      ▄▄ █▀  ∞█ ▄▀█Å"▀█▌ ,▄██▄▌  ▀▄,
//                     █⌂ ▀▀▀█▄ █▀▄▓▄▄█, ▐█▓▀    ▄▓▒█▌▓▄
//                     ▀█L, ▀▀██ █▓▀███▀▄▀█▓▓▓▓▓█▓▀▌█▓▓▓,F▀▀``²Ñ▄
//                    ▀N▄█▄▄ ▄` ▐█   ▐██ ▄╣▓╢██╫▀▄██▓▓▓▀█m╖,,,╓g█▓█▄
//                       ▀▄█═   ▐██▓▓▓▓▓▓╢▓█▓▓▀ ▄█╢▓▓▀  ▄▓▓█▄▓█▓█▓▓'
//                         █     ╢██▀▀▒╢███▓▀  ╒██▓▓▌   █▐▀▀▀▀▀▓█▓▓▌
//                        ▐▌   ▓▓▓▓▓▓█▓▓▀     ▐▓▓▓▓       ▐████╢╢▓,,,,,,,,,
//                          █▌ ▓▓▓▓╢██╢█▒▓@▄   ▐▓█╢▓     ▄█▀▀█▄▄,▄,▄▄▄▄▄▄▄▄▄▓▓▓▓BBBB▄▄
//                          `██▓▓▓▒█╢▒█▒▒▒▒▒▒▓╦▄▀▀██▓▄   █░]@╥▐████████████████▓▓▓▓▓▓█
//                          ██▓▓▓▓▐▌▓█▒▒▒▒▒▒▒▒▒▒▓W  ███▄ ▀█▄▄▄████████████████▓▓▓
//                       ,╓████▓▓▓╢██▒▓▄▒▒▒▒▒▒▒▒▒▒▀   █▒█▓▓▀▀▀████▓▓▓▓█▀█▓▓▓▓▓▓██▄mmmm
//                    ┌╥▀▀ ▀▓███╢▓▓▓▓██▓████████▄▄Æ▓▓███▓▓█▀         ▀▀▀▀▀▀▓▓▓▓▓▓▓████
//                  ▄▀`   ,▄▄▄███╢▓▓▓▓╢╣▓████████▓█▀██▓▓█▀
//                ▄██▄▄▓▓▓███▓▓╢╢▓▓▓▀`  `▀▀▀▀▀▀````▓▒█╣▓▄
//             ▄█╩▀  ,▓██▓███╣▓▓▓          ╜    `  ▐▓╢█▓█
//           ,█▌   J▓█▓██████▌▓▓         ▒         ▐▓▓▓█▓▓
//         ▄█▀ ╥╥▄████╢▓██▓██▌▓▓▓         ▒▒▒▒▒▒  ╓▓▓╫██▓▓▌ ,  ,
//        █▀▄   ▀▓█╢▓▀```╙▀▓███▓╣▓&▄▄           ,▓▓▓▓█████▀█▄█▐√█,▄▄
//        `█\█Y▌▐█╣▓▓▓▄▄, ,.'╙╙╨▀█████▓▄█▌▄▌▄▄▄▓▓▓▓╢███▀▀██▌▄▄▄▄ █▓▌
//         ▀▄▄██████▓╢▓▓▓█▓g▄▒, └ ▀██▀▓╔▄▄╗▐▓▓▓▓╢▓██▓█▒▓████▓██▓█▌▓▌
//    ▓▓▓▓▓▓▒██████▓████████╢▓▓▓▓▓▓███████▀███████████████████"▄█╢▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
//    ▓▓▓▓▓▓▓██▓████████████████████████▓▓▄█▓▓▓▓▓▓▓▓▓▓▓▓▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
//    ▓▓▓▓╢█▓█▓█▓▓▓▓▓▓▓▓▓╢╣╢▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▌▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
//    ▓▓▓▓█▓█╣▒╢▓▓▓▓▓▓╢╢╢╢▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▓▒╢╢╢╢▓▓▓▓▓▓▓█▓▓▓█▓▓▓▓█╢▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
        


//SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.20;

import "erc721a/contracts/ERC721A.sol";
import "@openzeppelin/contracts/token/common/ERC2981.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "operator-filter-registry/src/DefaultOperatorFilterer.sol";

contract FatPepe is ERC721A, ERC2981, DefaultOperatorFilterer, Ownable {
    uint256 public constant MAX_PER_WALLET = 5;
    uint256 public constant MAX_SUPPLY = 6969;
    uint256 public constant PRICE = 0.0049 ether;
    bool public saleActive;
    string private baseUri;
    
    constructor(
        string memory _baseUri
    ) ERC721A("FatPepe", "FAT") {
        saleActive = false;
        _mint(msg.sender, 5);
        baseUri = _baseUri;
        setDefaultRoyalty(msg.sender, 500);
    }

    function mint(uint256 quantity) public payable {
        require(saleActive, "Mint not active");
        require(msg.sender == tx.origin, "No contracts allowed");
        require(_totalMinted() + quantity <= MAX_SUPPLY, "Sold Out");
        require(balanceOf(msg.sender) + quantity <= MAX_PER_WALLET, "Exceeds max per wallet");

        if (_getAux(msg.sender) < 1) {
            _setAux(msg.sender, 1);
            if (quantity > 1){
                require(PRICE * (quantity - 1) <= msg.value,"Insufficient funds sent");
            }
        } else {
            require(PRICE * quantity <= msg.value,"Insufficient funds sent");
        }
        _mint(msg.sender, quantity);
    }

    function setApprovalForAll(address operator, bool approved) public override onlyAllowedOperatorApproval(operator) {
        super.setApprovalForAll(operator, approved);
    }

    function approve(address operator, uint256 tokenId) public payable override onlyAllowedOperatorApproval(operator) {
        super.approve(operator, tokenId);
    }

    function transferFrom(address from, address to, uint256 tokenId) public payable override onlyAllowedOperator(from) {
        super.transferFrom(from, to, tokenId);
    }

    function safeTransferFrom(address from, address to, uint256 tokenId) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId);
    }

    function safeTransferFrom(address from, address to, uint256 tokenId, bytes memory data) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId, data);
    }

    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC721A, ERC2981) returns (bool){
        return ERC721A.supportsInterface(interfaceId) || ERC2981.supportsInterface(interfaceId);
    }

    function _startTokenId() internal view virtual override returns (uint256) {
        return 1;
    }

    function _baseURI() internal view override returns (string memory) {
        return baseUri;
    }

    function withdrawAll() external onlyOwner {
        (bool os, ) = payable(msg.sender).call{value: address(this).balance}("");
        require(os);
    }

    function freeMintedForAddress(address owner) external view returns (uint64) {
        return _getAux(owner);
    }

    function setBaseUri(string memory _uri) external onlyOwner {
        baseUri = _uri;
    }

    function setMintActive() external onlyOwner {
        saleActive = !saleActive;
    }

    function setDefaultRoyalty(address receiver, uint96 feeNumerator) public onlyOwner {
        _setDefaultRoyalty(receiver, feeNumerator);
    }

    function deleteDefaultRoyalty() public onlyOwner {
        _deleteDefaultRoyalty();
    }
}