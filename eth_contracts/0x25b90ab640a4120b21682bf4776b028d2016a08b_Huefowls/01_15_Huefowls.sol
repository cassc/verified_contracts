// SPDX-License-Identifier: Ressssstricted
/*
+ + + - - - - - - - - - - - - - - - - - - - - - - - - - - - ++ - - - - - - - - - - - - - - - - - - - - - - - - - - + + +
+                                                                                                                      +
+                                            &&&&###BBBBGGGGGGGPPPPPPGGGGGGGBBBB###&&&                                 +
.                                   &&#BGP55YYYYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJYYY55PPGB#&                        .
.                                #G5YJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJYYPB&                    .
.                              B5JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJY5#                  .
.                            BYJJJ??JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ??JJJ5#                .
.                          B5JJJ77?JJJJJJJYYYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJYYYJJJJJJJ?7?JJJ5#              .
.                        &5JJJ7!7JYJJJYYYYYYJJJJJJJJJJJJJJJJJJ?????????JJJJJJJJJJJJJJJJYYYYYYYJJJYJ7!7JJYP&            .
.                       GYJJ7!!?JJJYYYYYYYJJJ5YJJJJJJJJJJJJJJ?77????77??JJJJJJJJJJJJJYYJJJYYYYYYJJJJ?!!7JJYB           .
.                     #5JJ7!!7JYJYYYYYYYJJJJ5J^?YJJJJJJJJJJJJJJ??????JJJJJJJJJJJJJJY7^5YJJJJYYYYYYYJYJ7!!?JJP&         .
.                    GYJ?!!!?JJYYYYYYYJJJJJYG...^?5JJJJJJJJJJJJJJJJJJJJJJJJJJJJJY57^. ~GJJJJJJYYYYYYYJJ?!!!?JY#        .
.                  &PJ?7!!7JYYYYYYYYYJJJJJJ55.:..? BJYJJJJJJJJJJJJJJJJJJJJJJJJYY& ~.:::GYJJJJJJYYYYYYYJYJ7!!7?JG       .
.                 #YJ7!!!?JYYYYYY5YJJJJJJJJYP::..Y P.!JYJJJJJJJJJJJJJJJJJJJYYJ~:# 7...~GJJJJJJJJJY5YYYYYJJ?!!!7J5&     .
.                GJ?!!!7JYYYYYYYP5JJJJJJJJJJ5J:..~&5 .?PJJJJJJJJJJJJJJJJJJJYP!..BB:..:5YJJJJJJJJJYP5YYYYYYJ?7!!7?YB    .
.              &PJ7!!!?JYYYYYYYGPJJJJJJJJJJJJYY!^^~7755JJJJJJJJJJJJJJJJJJJJJY5Y77^^~7YYJJJJJJJJJJJYBPYYYYYYYJ7!!!?JG   .
.             &5?7!!!?JYYYYYY5GPYJJJJJJJJJJJJJJYYYYYYYJJJJJJJJJJJJJJJJJJJJJJJJYYYYYYYJJJJJJJJJJJJJJ5GGYYYYYYYJ?!!!7JP  .
.            #Y?!!!7JYYYYYYY5G??PJJJJJJJJJJJJJJJJJJJJJJJJJJJYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJP?YG5YYYYYYYJ7!!7?5&.
.           BY?!!!?JYYYYYYYPG7~!JPYJJJJJJJJJJJJJJJJJJJJJJYJJ?JJJJJJJJJ??JJYJJJJJJJJJJJJJJJJJJJJJJYGY!~JG5YYYYYYYJ7!!!?Y.
.          BJ?!!!?JYYYYYYYPP!~!!~?P5JJJJJJJJJJJJJJJJJJJJJYYYY?JJJJJJJJ?YYYYJJJJJJJJJJJJJJJJJJJJJPGJ~!!~7G5YYYYYYYJ?!!!?.
.         GJ?!!7JYYYYYYYYPP!!!!!!~!YP5JJY5YJJJJJJJJJJJJJJJJJYYJJJJJJJJYJJJJJJJJJJJJJJJJJJY5YJJ5G57~!!!!~7GPYYYYYYJYJ7!!.
.        GJ?!!?JJYYYYYYYG5!!!!!!!!!~7YPYJYPP555PP5PYJJJJJJJJJJJJJJJJJJJJJJJJJJJJ5P555555P5YJ5G57~!!!!!!!~!GPYYYYYYJJJ?!.
.       GJ?!7JYJYYYYYYYG5!!!!!!!!!!!!~75PYJY5P#&#PGBPYJJJJJJJJJJJJJJJJJJJJJJJJ5GBGPPPP55YJYP57~!!!!!!!!!!!!PPYYYYYYJJJJ.
.      GJJ??JJJJYYYYYYG5!!!~:^~!!!!!!!!~?P5JJY##5YY5BBGPPGGGGGGGGGGGGGGGGGGGPGBG5YYYYJJJJ5P?~!!!!!!!!~^^~!!!GPYYYYYYJJJ.
.     BJJJJJJJJYYYYYYPP!!!~::::^~!!!!!!!~!YPJG#PJJYYYPPPPPGGGGGGGGGGGGGGGGGPPP5YYYJJJJJYPY!~!!!!!!!~^:::^!!!!G5YYYYYYJJ.
.    #YJJJJJJJYYYYYYPP!!!~::::::::^~!!!!!!~?G#GJJJJJJJJYYYYYYYYYYYYYYYYYYYYYYJJJJJJJJJ5P?~!!!!!!~~^::::::^!!~7G5YYYYYYJ.
.   &YJJJJJJJYYYYYY5G!!!!^:::::::::::^~~~!!!G&PYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJYP57~!!~~~^^::::::::::^!!~?BYYYYYYJ.
.   PJJJJJJJJYYYYYYB?~!!^::::::::::::::::::J&Y!5P55YYYYYJJJJJJJJJJJJJJJJJJJJJYYYY55P57^^^::::::::::::::::::^!!~YGYYYYYY.
.  #JJJJJJJJYYYYYYG5~!!^::::::::::::::::::^BB^.:^!?JYY5555PP5PPPPPPPPPPP5PP5555YJ?7~::::::::::::::::::::::::^!!!G5YYYYY.
.  PJJJJJJJJYYYYY5B7!!^:::::::::::::::::::Y&7.::::.:::::^^^^~~~~~~~~~~~~^^^^:::::.:::::::::::::::::::::::::::~!~?GYYYYY.
.     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *      .
.   *     ______ __           __     __                _______               ___                  __              *    .
.   *     |      |  |--.--.--.|  |--.|  |--.--.--.     |   |   |.--.--.-----.'  _|.-----.--.--.--.|  |.-----.     *    .
.   *     |   ---|     |  |  ||  _  ||  _  |  |  |     |       ||  |  |  -__|   _||  _  |  |  |  ||  ||__ --|     *    .
.   *     |______|__|__|_____||_____||_____|___  |     |___|___||_____|_____|__|  |_____|________||__||_____|     *    .
.   *                                         |__|                                                                *    .
.     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *      .
.     &5J!7JJJJJJJJJYB?!77!~^^^^^^^^^^..:^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^~777!JBYJJJJJJJ.
+      &Y?!7JJJJJJJJJ5B7!777~^^^^^^^^:.:^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^~777!JBYJJJJJJJJ+
+       &Y7!7JJJJJJJJYPG7!777~^^^^^^:..^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^!777!?B5YJJJJJJJJ+
+ + + - - - - - - - - - - - - - - - - - - - - - - - - - - - ++ - - - - - - - - - - - - - - - - - - - - - - - - - - + + +
*/
pragma solidity ^0.8.17;

import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/common/ERC2981.sol";
import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";
import "operator-filter-registry/src/DefaultOperatorFilterer.sol";
import "erc721a/contracts/ERC721A.sol";


/*
*  @title Chubby Huefowls - Najas Nation honorary collection
*  @author elitechimp.eth
*/
contract Huefowls is ERC721A, Ownable, DefaultOperatorFilterer, ERC2981 {

    uint8 private constant MAX_SUPPLY = 137;
    uint8 private constant MAX_QUANTITY_PER_WALLET = 2;

    string public baseURI;
    bytes32 public merkleRoot;
    bool public privateSaleIsActive = false;
    bool public publicSaleIsActive = false;
    address public receiverAddress;
    uint8 public royaltiesPercent = 10;

    constructor() ERC721A("Chubby Huefowls", "HUEFOWL") {
        receiverAddress = address(this);
    }

    modifier callerIsUser() {
        require(tx.origin == msg.sender, "The caller is another contract");
        _;
    }

    // ------------------------------------------------------------------
    //                          Mint functions
    // ------------------------------------------------------------------

    function privateMint(uint _quantity, bytes32[] calldata _proof) external callerIsUser {
        require(isWhiteListed(msg.sender, _proof), "not in the allowlist");
        require(privateSaleIsActive, "allowlist sale is not active");
        require(numberMinted(msg.sender) + _quantity <= MAX_QUANTITY_PER_WALLET, "can not mint this many");
        _safeMint(msg.sender, _quantity);
    }

    function publicMint(uint _quantity) external callerIsUser {
        require(publicSaleIsActive, "Public sale is not activated");
        require(numberMinted(msg.sender) + _quantity <= MAX_QUANTITY_PER_WALLET, "can not mint this many");
        require(totalSupply() + _quantity <= MAX_SUPPLY, "would exceed max tokens");
        _safeMint(msg.sender, _quantity);
    }

    // ------------------------------------------------------------------
    //                         Utility functions
    // ------------------------------------------------------------------

    function isWhiteListed(address _account, bytes32[] calldata _proof) internal view
    returns (bool)
    {
        return _verify(leaf(_account), _proof);
    }

    function leaf(address _account) internal pure returns (bytes32) {
        return keccak256(abi.encodePacked(_account));
    }

    function _verify(bytes32 _leaf, bytes32[] memory _proof) internal view
    returns (bool)
    {
        return MerkleProof.verify(_proof, merkleRoot, _leaf);
    }

    function numberMinted(address owner) public view
    returns (uint256)
    {
        return _numberMinted(owner);
    }

    function _baseURI() internal view virtual override
    returns (string memory)
    {
        return baseURI;
    }

    function tokenURI(uint256 tokenId) public view virtual override
    returns (string memory)
    {
        string memory uri = super.tokenURI(tokenId);
        return bytes(uri).length != 0 ? string(abi.encodePacked(uri, ".json")) : '';
    }

    // ------------------------------------------------------------------
    //             Operator filter and ERC2981 for royalties
    // ------------------------------------------------------------------

    function setApprovalForAll(address operator, bool approved) public override onlyAllowedOperatorApproval(operator)
    {
        super.setApprovalForAll(operator, approved);
    }

    function approve(address operator, uint256 tokenId) public override payable onlyAllowedOperatorApproval(operator)
    {
        super.approve(operator, tokenId);
    }

    function transferFrom(address from, address to, uint256 tokenId) public payable override onlyAllowedOperator(from) {
        super.transferFrom(from, to, tokenId);
    }

    function safeTransferFrom(address from, address to, uint256 tokenId) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId);
    }

    function safeTransferFrom(address from, address to, uint256 tokenId, bytes memory data) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId, data);
    }

    function setReceiverAddress(address _receiverAddress) external onlyOwner {
        require(_receiverAddress != address(0));
        receiverAddress = _receiverAddress;
    }

    function setRoyaltiesPercent(address _royaltiesPercent) external onlyOwner {
        receiverAddress = _royaltiesPercent;
    }

    function royaltyInfo(uint256 tokenId, uint256 salePrice) public view virtual override
    returns (address receiver, uint256 royaltyAmount)
    {
        require(_exists(tokenId), "Nonexistent token");
        return (receiverAddress, SafeMath.div(SafeMath.mul(salePrice, royaltiesPercent), 100));
    }

    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC721A, ERC2981)
    returns (bool)
    {
        return ERC721A.supportsInterface(interfaceId) || ERC2981.supportsInterface(interfaceId);
    }


    // ------------------------------------------------------------------
    //                    Administration functions
    // ------------------------------------------------------------------

    function setMerkleRoot(bytes32 _merkleRoot) external onlyOwner {
        merkleRoot = _merkleRoot;
    }

    function gift(address _to, uint _quantity) external onlyOwner {
        require(totalSupply() + _quantity <= MAX_SUPPLY, "Reached max Supply");
        _safeMint(_to, _quantity);
    }

    function setBaseUri(string memory _baseURI) external onlyOwner {
        baseURI = _baseURI;
    }

    function setPrivateSaleState(bool newState) external onlyOwner {
        privateSaleIsActive = newState;
    }

    function setPublicSaleState(bool newState) external onlyOwner {
        publicSaleIsActive = newState;
    }

    function withdraw() external onlyOwner {
        (bool success, ) = msg.sender.call{value: address(this).balance}("");
        require(success, "Transfer failed.");
    }

}
/*
+ + + - - - - - - - - - - - - - - - - - - - - - - - - - - - ++ - - - - - - - - - - - - - - - - - - - - - - - - - - + + +
+                              WWWW                                        WNXK0OOOOO0OOOOOOOOkkkOkkO000000KN          +
+                           WNXKKXW                                      WWNKOkkkkkO00OkOOkkOOkkO0OkO0KOOO0XW          +
.                          NK00KNW                                    WNKKK0OOO0OkkOkO0OkOkOOOOkkOO0O00O0KXW           .
.                         N0OOOKW                                   NKK0OOOOkkOOOOOOO0OkOOkkkOkkkOK00000XN             .
.                         XOOOOOKNWW                             WNKOOOOOOOOOOOOkOOkkkO0OkkxxkOOOO0000OKNW             .
.                         WKOOOOOO0KXNWW                      WNK00OOkOOkkOOkkOkkOOOOkkOkOOOkOOO0K0OOKXN               .
.                          WNK0kkkkkOO00KXNW               WNXK0O0OOO00OkOOOO0OOOOO0kkOOkkOOkkO0KKOOKN                 .
.                             WNXK0OOOOOkkkOXW         WWNXK0OOOOOOkkOOkOOkkkkOOOkkOkOOOkxkkkOOO00KKNW                 .
.                                 WWNKOkkkxdxKW      WNKK00000OO00OO00OkOOOOOkOOO00OkkkkxkkkO000XNWWW                  .
.                                    WKxxkkkdkX   WNXK00OOO00OOO00OO0OO0OkOOO0Okk0OkkkkkxkkkOKNW                       .
.                                     Xkxkkkxd0WWNK0000000KKKKKKK00KKOOOkkkO00OkkkkOkkkkxk0XNW      WWWWWWWNNWWW      W.
.XXNNXXXXXXXXXXXXXNNNNNNNNNWWWWWWWWWNXOkkkkxddkKK0OO0KKOOK0OO0K00KKKOkOOOOOkOOOOOkkkxxxkOKXNNNXXXXKKK00KKK0000KKKKXXXXK.
.000OOO00OOOOOOkOOOOOOOOOOO00000KKK0OOkkkxxoodk0K000KKKKKKK00K000OO0OkOOOOkOOkkOOkkxxxkk00000OOO00OOOOOOOOOOOOOOOOOO0O0.
.O000OOOOOOOOOOOOOOOOOOO000OOOkkkOOkkkkxxdddkOOKKKKK00KK00KKK0Okkk0OkkOkOkkkOkkkxkkkkOOOO000OOOOOO000000O000O00OO0000OO.
.OO0OkkOkkkkxkkkkOOkOOkkkkkkkkxxxxxdodddddkO0000OO000O00O000OOOkkOOkOOOOOOOOkxxxxOOOOOO000000OOOOO00000OO00000OOOO0OO0O.
.kxkkkxxkxkxxxxxxxxxxxxxxdddxxxxxxxxxxkxkkOOOOO0K00K00KKOOOkkOOkkkOO0OkOkxkxxxkOOO0000O00O00OOOOO0OO00OO000000OOOO0000O.
.xdxxxxxxxxdooddddddddxxxxkkkkOOOOOOOOkO00K0K0KK0O000KK0OOkxxkOkOOkOOOOOkxxkkOOO000000OOOOOOO0OO00O0OOOOOOOO0OO00OOOOOO.
.doddddddxxxxdxxkkkkkkkOOOOOOO0OOOOOkkkOOO00000000O0000OkkOOOOOOOOkOOOOkxkO000OO0O0OO00000O00000OOOOOOkkkkkkkkkkkOOOkO0.
.kxxkkkkkkkkOOOOOOOOOOOOkOOOOO00OOOOkkO0OOOOOO00K00K00OkOOkkOOxkOOOOkxxkOOOOOkOkkOOOO0OOOOOOOOkkkkkkkkkkkkkkkkkkkkkkkOO.
.OOOOOOOO0OO00O00OOOOOOOOOOOOOO0OOOkOKKKKKKO0K000O00kkOOkOkOOOkO0kkkxxkkkkkkkkkkkkkkOkkkkkkkkkkkkkkkkkkkkkkkkkkkkxxkkkk.
.OOOOO0000OOO0OOOOOOOOO0OOO00OO00OOkO0O00KK0KK00KK00OkOkkOOO0OkkOkkkxxkkkkkkkkkkkxkkxkkkkkkkkkkkkkkkkkkkkkkkkxxxxdddxkO.
.OOOOOOOOOOOOOOOOOkOOOO000O000OOOkxkO00kO00O0KKKK000OkkxkkxkkkkkOkxxkkkkkOkkkxkxxkkkkkkkkkkkkkkkkxxxkkxxxddddoodxxxkO00.
.kOOO0OkOOOOOOOOOOOOOOOOOOkkOkkkkkO00K000000OKKOOkO0kkOkkxkOkO0kkkkOOkkkxxxddddddddxxxxxdddxxddxxxxxxxxxkkkkkkO0000O000.
.kkkkkkkOOOOOOkkkOOkkkxkkkkxkkkkxxOOOO00000OOK0kOkkOxkkkOkkOkOOOkxkOOO0OOOkxxxxkkkxxkkkxxxxkOkkkOO000O000000000000000KK.
.xxxxxkkkkkkkkxxxkkxxkxxxkkkkkkkxxkOOOOO0OkkOOkk0OkkkkxkkkkkkkkOkkO000KK0OO000KKK0O0000000OO00000OO00000OO0K00000000000.
.xxxxkxxxxxxxdxxxxxxxxxkkkxkkkkxxO00K00OkkkOkxkkOkkkkOkkOkkO0OOkk0K0OO0K0OO00000O0KKK0OOO0000OO00000OO000OOO0K0OO0KKK0O.
.xxxxkxxxxxxddxxdddxxdxxxdddddoddxOOOO0kxkOOkkOOkkkkkkkkOkkOOOkkOO00O00K00000000O0000000000K0000000000OO00OO00000000K00.
.ddddddxdxxxxxxxxxkkkOOOOOO0000KOOOO0OkkkkxkkkOOOOOkkOkkOkkO00OO00O00KK00O00K0OO0KKKOO0000KKKKK0000KKK0OOOO00OO0K000000.
.xkO000KKKXNNNNNNWWWWWW         X0O00OOkxxkOOOkkkkOkkOkkOOkkOOkkO0OkO0KK000KK0OO00K0OO0KKK00OO0KK0OOOO000O000OO00K00OOk.
.WW                             WX0OkkOkkkOOOkxkkkkkOkxkOOkkkkxxOOOkkOOOOO0K00000KKK0OO00K000OOO00000OOOOOOO0OkOOOOOOOk.
.                                 N0kkOkkkkkxkkkOkkOkkxkkOkkkkxxkOkkkkkkkOOOOO0KK00KK0000000OOO0000OOOOOOOOkOOOOOkkkOOk.
.                                 WNKOkkOkkkkkkkkOkkOkkOOkkkkkkkOOkkkkkkkOOOOOOOOkO000OOOO000OOO00O0OOOkkOOkkkOOOkxkOOk.
.                                    NKOkOOkkkxkOkkkkkxxOOkkkkkkkOkxkOOOOkkOOOOkkOkkOOOOkkOOkkkOOOOkxxkOO0OkkkOOOkkkOOO.
.                                      NXK0kxkkkkkxkOkkkkkkkkkkxxkkOkkxkkkOOkkkOOOOOkkkkOkOkkkOOkkOO0OkkkkkkkkkkOOkkkkk.
.                                         WNK0OkxxkkkkkkkkOkkxxkkkkkOOkkkkOOkxxkOOOkkkkOOkkkkOkkkkOkkkkkOOkkxkkOkkkkkkk.
.                                            WNXK0OkxdxkxxkkkkxxkOOkkkOOOkkOkxkkkkkxxkOkkkkOOOkkkkkxxkkkkxkkkxxkkxxkxkk.
.                                                WWNX0OOkxxxxxdxxxxxxkkxxxxxkkkxddxxkkOkddxkkkkkxdxxkkxddxdddoddddxdddx.
+                                                      WWNNXKKK00OOkkkkxxxddxkkkxxxxddxxxdxxxxkkkxxkkkkkkkOO000KKKXXXXX+
+   From Najas Nation                                           WWWWWNNXKKKKXXNNXXXXK0KKKKKKXNNNNNNNWNNWWW             +
+ + + - - - - - - - - - - - - - - - - - - - - - - - - - - - ++ - - - - - - - - - - - - - - - - - - - - - - - - - - + + +
*/